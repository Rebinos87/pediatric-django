#!/usr/bin/env python
"""
Load Complete CDC/WHO Growth Percentile Data
Run this in Django shell: python manage.py shell < load_growth_data.py
Or in Django: exec(open('load_growth_data.py').read())
"""

import os
import django

# Setup Django
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from pediatric.models import GrowthPercentile

# Clear existing data (optional - comment out to keep existing data)
# GrowthPercentile.objects.all().delete()
# print("âœ“ Cleared existing data")

# WHO BOYS HEIGHT (0-24 months)
who_boys_height = [
    (0, 'Male', 'Height', 'WHO', 45.5, 46.0, 46.5, 47.5, 49.0, 50.5, 51.5, 52.0, 52.5),
    (3, 'Male', 'Height', 'WHO', 55.5, 56.5, 57.0, 58.5, 60.0, 61.5, 63.0, 63.5, 64.5),
    (6, 'Male', 'Height', 'WHO', 63.5, 64.5, 65.5, 67.5, 69.0, 71.0, 72.5, 73.5, 74.5),
    (9, 'Male', 'Height', 'WHO', 70.5, 71.5, 72.5, 74.5, 76.0, 78.0, 80.0, 81.0, 82.0),
    (12, 'Male', 'Height', 'WHO', 75.5, 76.5, 77.5, 79.5, 81.0, 83.5, 85.5, 86.5, 88.0),
    (15, 'Male', 'Height', 'WHO', 80.0, 81.0, 82.0, 84.0, 85.5, 88.0, 90.0, 91.0, 92.5),
    (18, 'Male', 'Height', 'WHO', 83.5, 84.5, 85.5, 87.5, 89.0, 91.5, 93.5, 94.5, 96.0),
    (21, 'Male', 'Height', 'WHO', 86.5, 87.5, 88.5, 90.5, 92.0, 94.5, 96.5, 97.5, 99.0),
    (24, 'Male', 'Height', 'WHO', 89.0, 90.0, 91.0, 93.0, 94.5, 97.0, 99.0, 100.5, 102.0),
]

# WHO GIRLS HEIGHT (0-24 months)
who_girls_height = [
    (0, 'Female', 'Height', 'WHO', 44.5, 45.0, 45.5, 46.5, 48.0, 49.5, 50.5, 51.0, 51.5),
    (3, 'Female', 'Height', 'WHO', 54.5, 55.5, 56.0, 57.5, 59.0, 60.5, 62.0, 62.5, 63.5),
    (6, 'Female', 'Height', 'WHO', 62.5, 63.5, 64.5, 66.0, 67.5, 69.5, 71.0, 72.0, 73.0),
    (9, 'Female', 'Height', 'WHO', 69.0, 70.0, 71.0, 73.0, 74.5, 76.5, 78.5, 79.5, 80.5),
    (12, 'Female', 'Height', 'WHO', 73.5, 74.5, 75.5, 77.5, 79.0, 81.0, 83.0, 84.0, 85.5),
    (15, 'Female', 'Height', 'WHO', 78.0, 79.0, 80.0, 82.0, 83.5, 85.5, 87.5, 88.5, 90.0),
    (18, 'Female', 'Height', 'WHO', 81.5, 82.5, 83.5, 85.5, 87.0, 89.0, 91.0, 92.0, 93.5),
    (21, 'Female', 'Height', 'WHO', 84.5, 85.5, 86.5, 88.5, 90.0, 92.0, 94.0, 95.0, 96.5),
    (24, 'Female', 'Height', 'WHO', 87.0, 88.0, 89.0, 91.0, 92.5, 94.5, 96.5, 97.5, 99.0),
]

# WHO BOYS WEIGHT (0-24 months)
who_boys_weight = [
    (0, 'Male', 'Weight', 'WHO', 2.0, 2.1, 2.2, 2.5, 2.8, 3.1, 3.4, 3.6, 3.8),
    (3, 'Male', 'Weight', 'WHO', 4.2, 4.4, 4.6, 5.0, 5.5, 6.0, 6.6, 7.0, 7.3),
    (6, 'Male', 'Weight', 'WHO', 6.0, 6.3, 6.6, 7.3, 8.0, 8.9, 9.9, 10.4, 11.0),
    (9, 'Male', 'Weight', 'WHO', 7.3, 7.7, 8.1, 8.9, 9.7, 10.8, 12.0, 12.6, 13.4),
    (12, 'Male', 'Weight', 'WHO', 8.3, 8.8, 9.2, 10.2, 11.0, 12.3, 13.6, 14.3, 15.1),
    (15, 'Male', 'Weight', 'WHO', 9.2, 9.8, 10.2, 11.4, 12.3, 13.7, 15.1, 15.9, 16.9),
    (18, 'Male', 'Weight', 'WHO', 9.9, 10.6, 11.0, 12.4, 13.3, 14.9, 16.5, 17.3, 18.5),
    (21, 'Male', 'Weight', 'WHO', 10.6, 11.3, 11.8, 13.2, 14.3, 16.0, 17.7, 18.6, 19.9),
    (24, 'Male', 'Weight', 'WHO', 11.3, 12.1, 12.6, 14.2, 15.3, 17.2, 19.1, 20.1, 21.5),
]

# WHO GIRLS WEIGHT (0-24 months)
who_girls_weight = [
    (0, 'Female', 'Weight', 'WHO', 1.9, 2.0, 2.1, 2.4, 2.7, 3.0, 3.3, 3.5, 3.7),
    (3, 'Female', 'Weight', 'WHO', 3.9, 4.1, 4.3, 4.8, 5.2, 5.8, 6.4, 6.8, 7.1),
    (6, 'Female', 'Weight', 'WHO', 5.3, 5.6, 5.9, 6.6, 7.3, 8.2, 9.2, 9.8, 10.4),
    (9, 'Female', 'Weight', 'WHO', 6.6, 7.0, 7.4, 8.2, 9.0, 10.2, 11.5, 12.2, 13.0),
    (12, 'Female', 'Weight', 'WHO', 7.6, 8.1, 8.5, 9.4, 10.3, 11.6, 13.1, 13.9, 14.9),
    (15, 'Female', 'Weight', 'WHO', 8.4, 9.0, 9.4, 10.5, 11.5, 13.0, 14.6, 15.5, 16.7),
    (18, 'Female', 'Weight', 'WHO', 9.0, 9.7, 10.1, 11.3, 12.4, 14.0, 15.7, 16.7, 18.0),
    (21, 'Female', 'Weight', 'WHO', 9.6, 10.4, 10.8, 12.1, 13.3, 15.0, 16.9, 17.9, 19.4),
    (24, 'Female', 'Weight', 'WHO', 10.2, 11.0, 11.5, 12.9, 14.2, 16.1, 18.1, 19.2, 20.9),
]

# CDC BOYS HEIGHT (24-240 months / 2-20 years)
cdc_boys_height = [
    (24, 'Male', 'Height', 'CDC', 82.8, 84.0, 85.2, 87.5, 91.0, 94.5, 98.0, 99.2, 100.4),
    (36, 'Male', 'Height', 'CDC', 90.0, 91.5, 92.8, 95.3, 99.0, 103.0, 107.0, 108.3, 109.8),
    (48, 'Male', 'Height', 'CDC', 96.0, 97.8, 99.0, 101.8, 105.8, 110.0, 114.5, 116.0, 117.5),
    (60, 'Male', 'Height', 'CDC', 101.5, 103.5, 105.0, 108.0, 112.3, 117.0, 122.0, 123.5, 125.3),
    (72, 'Male', 'Height', 'CDC', 107.0, 109.2, 110.8, 114.0, 118.8, 124.0, 129.3, 131.0, 133.0),
    (84, 'Male', 'Height', 'CDC', 112.0, 114.5, 116.3, 119.8, 124.8, 130.5, 136.3, 138.2, 140.3),
    (96, 'Male', 'Height', 'CDC', 117.0, 119.8, 121.8, 125.5, 131.0, 137.0, 143.5, 145.5, 147.8),
    (108, 'Male', 'Height', 'CDC', 122.5, 125.5, 127.8, 131.8, 137.5, 144.0, 150.8, 153.0, 155.5),
    (120, 'Male', 'Height', 'CDC', 128.3, 131.5, 134.0, 138.3, 144.3, 151.2, 158.3, 160.8, 163.3),
    (132, 'Male', 'Height', 'CDC', 134.8, 138.3, 140.8, 145.5, 152.0, 159.3, 166.8, 169.5, 172.3),
    (144, 'Male', 'Height', 'CDC', 141.8, 145.5, 148.3, 153.3, 160.0, 167.5, 175.0, 177.8, 180.8),
    (156, 'Male', 'Height', 'CDC', 148.8, 152.8, 155.8, 161.0, 168.0, 175.5, 183.0, 185.8, 189.0),
    (168, 'Male', 'Height', 'CDC', 155.0, 159.3, 162.5, 168.0, 175.0, 182.5, 189.8, 192.5, 195.5),
    (180, 'Male', 'Height', 'CDC', 161.0, 165.3, 168.8, 174.0, 180.5, 187.5, 194.0, 196.5, 199.0),
    (192, 'Male', 'Height', 'CDC', 165.5, 170.0, 173.5, 178.8, 184.5, 190.8, 196.0, 198.0, 200.0),
    (204, 'Male', 'Height', 'CDC', 169.0, 173.5, 177.0, 182.0, 187.0, 192.8, 197.0, 198.5, 200.0),
    (216, 'Male', 'Height', 'CDC', 171.0, 175.5, 179.0, 183.5, 188.0, 193.0, 197.0, 198.5, 200.0),
    (228, 'Male', 'Height', 'CDC', 172.5, 177.0, 180.5, 184.5, 188.5, 193.0, 197.0, 198.5, 200.0),
    (240, 'Male', 'Height', 'CDC', 173.5, 178.0, 181.5, 185.5, 189.0, 193.0, 197.0, 198.5, 200.0),
]

# CDC GIRLS HEIGHT (24-240 months / 2-20 years)
cdc_girls_height = [
    (24, 'Female', 'Height', 'CDC', 81.6, 82.8, 84.0, 86.3, 90.0, 93.5, 97.0, 98.3, 99.5),
    (36, 'Female', 'Height', 'CDC', 88.3, 89.8, 91.0, 93.5, 97.0, 101.0, 105.0, 106.3, 107.8),
    (48, 'Female', 'Height', 'CDC', 94.0, 95.8, 97.0, 99.8, 103.5, 107.8, 112.0, 113.5, 115.0),
    (60, 'Female', 'Height', 'CDC', 99.5, 101.5, 103.0, 106.0, 110.0, 114.8, 119.5, 121.0, 122.8),
    (72, 'Female', 'Height', 'CDC', 105.0, 107.3, 109.0, 112.3, 116.8, 121.8, 127.0, 128.8, 130.8),
    (84, 'Female', 'Height', 'CDC', 110.5, 113.0, 115.0, 118.5, 123.3, 128.8, 134.5, 136.5, 138.8),
    (96, 'Female', 'Height', 'CDC', 116.0, 118.8, 121.0, 124.8, 130.0, 135.8, 142.0, 144.3, 146.8),
    (108, 'Female', 'Height', 'CDC', 121.8, 125.0, 127.5, 131.8, 137.5, 143.8, 150.5, 153.0, 155.8),
    (120, 'Female', 'Height', 'CDC', 128.0, 131.5, 134.3, 139.0, 145.0, 151.8, 158.8, 161.5, 164.3),
    (132, 'Female', 'Height', 'CDC', 134.5, 138.3, 141.3, 146.3, 152.8, 159.8, 167.0, 170.0, 173.0),
    (144, 'Female', 'Height', 'CDC', 141.0, 145.0, 148.3, 153.8, 160.5, 167.8, 175.0, 178.0, 181.0),
    (156, 'Female', 'Height', 'CDC', 147.0, 151.3, 154.8, 160.5, 167.0, 174.0, 180.5, 183.0, 185.5),
    (168, 'Female', 'Height', 'CDC', 151.8, 156.3, 160.0, 165.8, 172.0, 178.8, 185.0, 187.0, 189.0),
    (180, 'Female', 'Height', 'CDC', 155.0, 159.8, 163.5, 169.0, 175.0, 181.5, 187.0, 189.0, 191.0),
    (192, 'Female', 'Height', 'CDC', 157.5, 162.0, 165.5, 170.8, 176.5, 182.5, 187.5, 189.0, 191.0),
    (204, 'Female', 'Height', 'CDC', 159.0, 163.0, 166.5, 171.5, 177.0, 182.5, 187.5, 189.0, 191.0),
    (216, 'Female', 'Height', 'CDC', 159.8, 163.8, 167.0, 172.0, 177.0, 182.5, 187.5, 189.0, 191.0),
    (228, 'Female', 'Height', 'CDC', 160.3, 164.0, 167.2, 172.0, 177.0, 182.5, 187.5, 189.0, 191.0),
    (240, 'Female', 'Height', 'CDC', 160.5, 164.0, 167.2, 172.0, 177.0, 182.5, 187.5, 189.0, 191.0),
]

# CDC BOYS WEIGHT (24-240 months / 2-20 years)
cdc_boys_weight = [
    (24, 'Male', 'Weight', 'CDC', 11.5, 12.0, 12.5, 13.5, 14.8, 16.5, 18.5, 19.5, 20.5),
    (36, 'Male', 'Weight', 'CDC', 13.5, 14.3, 15.0, 16.3, 18.0, 20.5, 23.5, 25.0, 26.5),
    (48, 'Male', 'Weight', 'CDC', 15.5, 16.5, 17.5, 19.0, 21.0, 24.0, 27.5, 29.5, 31.5),
    (60, 'Male', 'Weight', 'CDC', 17.5, 18.8, 20.0, 22.0, 24.5, 28.0, 32.0, 34.5, 37.0),
    (72, 'Male', 'Weight', 'CDC', 20.0, 21.5, 23.0, 25.5, 28.5, 32.5, 37.5, 40.5, 43.5),
    (84, 'Male', 'Weight', 'CDC', 22.5, 24.5, 26.0, 29.0, 32.5, 37.5, 43.5, 47.0, 51.0),
    (96, 'Male', 'Weight', 'CDC', 25.5, 27.8, 29.5, 33.0, 37.0, 43.0, 50.0, 54.0, 59.0),
    (108, 'Male', 'Weight', 'CDC', 29.0, 31.8, 34.0, 38.5, 43.5, 50.5, 59.0, 64.0, 70.0),
    (120, 'Male', 'Weight', 'CDC', 33.0, 36.5, 39.0, 44.0, 50.0, 58.0, 68.0, 74.0, 81.5),
    (132, 'Male', 'Weight', 'CDC', 38.0, 42.0, 45.0, 50.5, 57.5, 66.5, 77.5, 85.0, 94.0),
    (144, 'Male', 'Weight', 'CDC', 43.5, 48.0, 51.5, 57.5, 65.0, 75.0, 87.5, 96.0, 106.0),
    (156, 'Male', 'Weight', 'CDC', 49.5, 54.5, 58.5, 65.0, 73.5, 84.5, 98.0, 108.0, 120.0),
    (168, 'Male', 'Weight', 'CDC', 55.5, 61.0, 65.5, 73.0, 82.0, 94.0, 108.5, 120.0, 133.5),
    (180, 'Male', 'Weight', 'CDC', 61.5, 67.5, 72.5, 81.0, 90.0, 103.0, 118.5, 131.0, 145.5),
    (192, 'Male', 'Weight', 'CDC', 67.0, 73.5, 79.0, 88.0, 98.0, 111.5, 127.5, 140.5, 155.0),
    (204, 'Male', 'Weight', 'CDC', 71.5, 78.5, 84.0, 93.5, 104.0, 117.5, 133.0, 146.0, 161.0),
    (216, 'Male', 'Weight', 'CDC', 75.0, 82.0, 88.0, 97.5, 108.5, 122.0, 137.0, 150.0, 165.0),
    (228, 'Male', 'Weight', 'CDC', 78.0, 85.0, 91.0, 101.0, 112.0, 125.5, 140.0, 153.0, 168.0),
    (240, 'Male', 'Weight', 'CDC', 80.5, 88.0, 94.0, 104.5, 115.5, 129.0, 143.0, 156.0, 171.0),
]

# CDC GIRLS WEIGHT (24-240 months / 2-20 years)
cdc_girls_weight = [
    (24, 'Female', 'Weight', 'CDC', 11.0, 11.5, 12.0, 13.0, 14.3, 16.0, 18.0, 19.0, 20.0),
    (36, 'Female', 'Weight', 'CDC', 13.0, 13.8, 14.5, 15.8, 17.5, 20.0, 22.5, 24.0, 25.5),
    (48, 'Female', 'Weight', 'CDC', 15.0, 16.0, 17.0, 18.5, 20.5, 23.5, 26.5, 28.5, 30.0),
    (60, 'Female', 'Weight', 'CDC', 17.0, 18.3, 19.5, 21.5, 24.0, 27.5, 31.5, 34.0, 36.5),
    (72, 'Female', 'Weight', 'CDC', 19.5, 21.0, 22.5, 25.0, 28.0, 32.0, 37.0, 40.0, 43.5),
    (84, 'Female', 'Weight', 'CDC', 22.0, 23.8, 25.5, 28.5, 32.0, 36.5, 42.5, 46.0, 50.5),
    (96, 'Female', 'Weight', 'CDC', 25.0, 27.0, 29.0, 32.5, 36.5, 42.0, 49.0, 53.5, 59.0),
    (108, 'Female', 'Weight', 'CDC', 28.5, 31.0, 33.5, 37.5, 42.0, 48.5, 57.0, 62.5, 69.0),
    (120, 'Female', 'Weight', 'CDC', 32.5, 35.5, 38.5, 43.0, 48.5, 56.0, 66.0, 73.0, 81.0),
    (132, 'Female', 'Weight', 'CDC', 37.5, 41.0, 44.5, 50.0, 56.5, 65.0, 76.0, 85.0, 95.0),
    (144, 'Female', 'Weight', 'CDC', 43.0, 47.0, 51.0, 57.0, 64.5, 74.5, 87.0, 98.0, 109.0),
    (156, 'Female', 'Weight', 'CDC', 48.5, 53.0, 57.5, 64.0, 72.5, 83.5, 97.0, 109.0, 122.0),
    (168, 'Female', 'Weight', 'CDC', 53.5, 58.5, 63.0, 70.5, 79.5, 91.0, 105.0, 118.0, 131.0),
    (180, 'Female', 'Weight', 'CDC', 57.5, 63.0, 68.0, 76.0, 85.5, 97.5, 112.0, 125.0, 140.0),
    (192, 'Female', 'Weight', 'CDC', 60.5, 66.0, 71.0, 79.5, 89.5, 102.0, 117.0, 131.0, 147.0),
    (204, 'Female', 'Weight', 'CDC', 62.5, 68.0, 73.0, 81.5, 91.5, 104.5, 120.0, 135.0, 151.0),
    (216, 'Female', 'Weight', 'CDC', 63.5, 69.0, 74.0, 83.0, 93.0, 106.0, 121.0, 136.0, 152.0),
    (228, 'Female', 'Weight', 'CDC', 64.0, 69.5, 74.5, 83.5, 93.5, 106.5, 121.5, 136.5, 152.5),
    (240, 'Female', 'Weight', 'CDC', 64.0, 70.0, 75.0, 84.0, 94.0, 107.0, 122.0, 137.0, 153.0),
]

# Combine all data
all_data = (
    who_boys_height + who_girls_height + who_boys_weight + who_girls_weight +
    cdc_boys_height + cdc_girls_height + cdc_boys_weight + cdc_girls_weight
)

print(f"\nðŸ“Š Loading {len(all_data)} growth percentile records...\n")

# Create records
created_count = 0
for age, gender, chart, standard, p2, p5, p10, p25, p50, p75, p90, p95, p98 in all_data:
    obj, created = GrowthPercentile.objects.get_or_create(
        age_in_months=age,
        gender=gender,
        chart_type=chart,
        standard=standard,
        defaults={
            'percentile_2nd': p2,
            'percentile_5th': p5,
            'percentile_10th': p10,
            'percentile_25th': p25,
            'percentile_50th': p50,
            'percentile_75th': p75,
            'percentile_90th': p90,
            'percentile_95th': p95,
            'percentile_98th': p98,
        }
    )
    if created:
        created_count += 1
        status = "âœ“"
    else:
        status = "â†’"
    print(f"{status} {age:3d}mo | {gender:6s} | {chart:7s} | {standard:3s}")

print(f"\nâœ… SUCCESS! Created {created_count} new records")
print(f"ðŸ“ˆ Total percentile data points in database: {GrowthPercentile.objects.count()}\n")
print("Your charts now have RED LINES! ðŸŽ‰\n")
